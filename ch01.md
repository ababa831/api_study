# Chapter01 Web APIとは何か

- HTML 最終的に人間がブラウザ上で「読む」ことを前提とした情報が埋め込まれている
- API データを直接活用するための形式．さまざまな目的の二次加工に利用しやすい

### 本書の扱う範囲
URIにアクセスすると，シンプルにJSONやXMLが帰ってくる[XML over HTTP], [JSON over HTTP]と呼ばれるAPI

### 本書の目的
世の中には，厳密なルール・仕様に沿わず設計されたAPIががある．本書はちゃんとAPIを設計するためにはどうしたら良いかを目的とする

### REST
[XML over HTTP], [JSON over HTTP]を [REST API]と呼ぶ場合があるが，本来厳密な定義が存在している．単にHTTP経由でJSONとかを返すAPIをREST APIと呼ぶのは誤用or拡大解釈ね．本書では誤解を招かないように，こうした「広義のREST」をRESTとは呼ばないぞ （編集済み） 
（安易にRESTとか言いっちゃいそうになるけど，パブリックで使うとREST警察が来そうだから注意しよう．．）

## 1.1 WEB APIの重要性

近年，APIの存在が企業やサービスの収益や価値を左右するから
（Webサービスを提供しているのにAPIを公開してないのならば，はよ公開せい！）

過去の成功例: [2003 Amazon Product Advertising API] (EC2やS3が公開される以前)
このときはAWS ＝＝ Product Advertising APIだった

APIがアフィと結び付けられてた -> これを使って誰もがカンタにAmazonの商品を自分のサイトから販売し，その収益の一部を得られた -> ブログの普及とあいまって，Amazonの商品を購入するリンクがいたるところに貼り付けられる -> Amazonの収益めっちゃUP

過去の成功例2: [2006~ Twitter]
Twitter自体がシンプルなサービスだったので，APIを使うことで殆どの操作が可能だった

e.g. ガラケー読み書き，より使いやすいクライアント，データ分析サービス，Bot, etc.
-> 殆どの情報が集まる場 巨大なエコシステム化

Q. 無料で提供すると損しない？
A. 近視眼的にはそう見える．しかし，APIを公開すると外部の開発者が色々いじいじしてくれて，新しい付加価値を与えてくれるので，コアとなる自分たちのサービスがより発展する力が得られる

Q. APIを有料利用すると，自前で運用するよりコストかかりそうじゃない？
A. 自前で運用した場合は
- 開発・運用の人件費
- 開発にかかる時間
- 運用する能力をもつ人材を探すコスト
がかかる．そう考えると，API利用した方が割安だったりする

また，デファクトなサービス，よく使われているサービスでありAPIが公開されているならそれをつなぎ込んだ方が有利
なぜ？：つなぎ先のサービスを利用している人は別サービスに移行する必要がない -> ユーザにとって利用開始するコストが非常に下がるから

### 1.1.2 モバイルアプリケーションとAPI
スマホがサーバと通信する場合，WebAPI（外部には公開してないやつ）を使うケースが一般的．スマホ中心の世の中だからそりゃ重要だよね

### (おまけ)Swagger

[Swaggerまとめ](https://qiita.com/gcyata/items/342073fa7607fd4082bd)

UI上でどのAPIがいきてるのか(get, post, put, patch, delete)わかったり、paramかえて実際にrequest投げたり等便利

### 1.1.3 APIエコノミー
APIが重要性を増してきたので，APIそのものの構築や管理をビジネスとして行うサービスが増えてきた
このように，APIを中心としてビジネスが発展していくこのは＊APIエコノミー＊とよばれ近年注目 (この本は2013年ごろ) 

## 1.2 さまざまなAPIのパターン

APIを設計しなければならないケース
- 公開しているWebサービスのデータ・昨日をAPIとして提供するとき
- 他のページに貼り付けるウィジェットの公開
- モダンなWebアプリケーションの公開
- スマホアプリの開発
- ソシャゲの開発
- 社内システムの連携

### 1.2.1 公開しているWebサービスのデータ・昨日をAPIとして提供するとき
見ず知らずの第三者が利用することが前提

->

- きちんとドキュメント公開しろ
- 誰でもわかりやすい設計にしろ
- ユーザ登録・ユーザごとのアクセス制限などが必要な場合も
- 仕様変更する際，変更前のままを引きずって利用するユーザを考慮した戦略をとれ
- モバイルクライアント向けSDKの公開も検討しなきゃいけない場合もあり

### 1.2.2 他のページに貼り付けるウィジェットの公開
e.g. Facebookのいいねとか，アマゾンアフィのリンクとか

サードパーティJavaScriptで提供
- JavaScriptがバックエンドにあるAPIにアクセスして情報を送受信
- ウィジェット専用のAPIを用意することがある
- 第三者がウィジェットを作れるように公開する場合もある

設計にあたり考慮すべきこと
- ブラウザを使って他ページからAPIへのアクセスが行われる -> クロスドメインのアクセスサポート要
（クロスドメインってなに？ あとで調べる）
- ブラウザでアクセスできるので，クライアント側のコード誰でも簡単に読める -> なりすまし，不正アクセスがカジュアルにできやすくなる

[クロスドメインの解説](https://wa3.i-3-i.info/word15224.html)

### 1.2.3 モダンなWebアプリケーションの構築

- **昔** Webアプリは情報の切り替えの際にページが遷移
- **今** ページ読み込み・遷移とは別タイミングで情報を取得したり様々な機能を共有するのが当たり前

Why:<br>
- やり取りするデータサイズを小さくする
- やり取りタイミングをいい塩梅に調整する

ことで，より良いUXを提供可能だから

**こうしたサイトを構築する際APIは必須**

e.g. AJAX

JavaScript -> WebサーバからWebAPIを通して逐次情報を取得

[1.2.2 他のページに貼り付けるウィジェットの公開](https://github.com/ababa893/api_study/blob/master/ch01.md#122-%E4%BB%96%E3%81%AE%E3%83%9A%E3%83%BC%E3%82%B8%E3%81%AB%E8%B2%BC%E3%82%8A%E4%BB%98%E3%81%91%E3%82%8B%E3%82%A6%E3%82%A3%E3%82%B8%E3%82%A7%E3%83%83%E3%83%88%E3%81%AE%E5%85%AC%E9%96%8B)の場合と同じように，ブラウザからのアクセス前提．しかし，自サイトでアクセスする点が異なる

